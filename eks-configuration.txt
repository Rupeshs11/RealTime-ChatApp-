Complete EKS Setup â€” From Scratch to Running App  

Step 1: Launch EC2 (Management Machine)
AWS Console â†’ EC2 â†’ Launch Instance


Setting	Value
Name	eks-manager
AMI	Amazon Linux 2023
Instance Type	t2.micro (free tier)
Key Pair	Create or use existing
Security Group	Allow SSH (22) from your IP
Storage	20 GB
Step 2: SSH into EC2
bash
ssh -i "your-key.pem" ec2-user@<EC2-IP>
Step 3: Install CLI Tools
bash
# AWS CLI (already installed on Amazon Linux)
aws --version
# kubectl
curl -LO "https://dl.k8s.io/release/$(curl -Ls https://dl.k8s.io/release/stable.txt)/bin/linux/amd64/kubectl"
chmod +x kubectl
sudo mv kubectl /usr/local/bin/
kubectl version --client
# eksctl
ARCH=amd64
PLATFORM=$(uname -s)_$ARCH
curl -sLO "https://github.com/eksctl-io/eksctl/releases/latest/download/eksctl_$PLATFORM.tar.gz"
tar -xzf eksctl_$PLATFORM.tar.gz -C /tmp
sudo mv /tmp/eksctl /usr/local/bin
eksctl version
# helm
curl https://raw.githubusercontent.com/helm/helm/main/scripts/get-helm-3 | bash
helm version
Step 4: Configure AWS Credentials
First, create IAM User in AWS Console:

IAM â†’ Users â†’ Create User
Attach policies: AdministratorAccess (for eksctl)
Create Access Key â†’ Download
bash
aws configure
# AWS Access Key ID: <paste>
# AWS Secret Access Key: <paste>
# Default region: ap-south-1
# Default output format: json
# Verify
aws sts get-caller-identity
Step 5: Create EKS Cluster (~15-20 mins)
bash
eksctl create cluster \
  --name knoxchat-cluster \
  --region ap-south-1 \
  --nodegroup-name knoxchat-nodes \
  --node-type t3.small \
  --nodes 2 \
  --managed
Wait for it to complete. Then verify:

bash
kubectl get nodes
Step 6: Clone Your Repo
bash
git clone https://github.com/Rupeshs11/RealTime-ChatApp-.git
cd RealTime-ChatApp-
Step 7: Install EBS CSI Driver (for MongoDB storage)
bash
# Create IAM OIDC provider
eksctl utils associate-iam-oidc-provider \
  --region ap-south-1 \
  --cluster knoxchat-cluster \
  --approve
# Create service account for EBS CSI
eksctl create iamserviceaccount \
  --name ebs-csi-controller-sa \
  --namespace kube-system \
  --cluster knoxchat-cluster \
  --region ap-south-1 \
  --attach-policy-arn arn:aws:iam::aws:policy/service-role/AmazonEBSCSIDriverPolicy \
  --approve
# Install EBS CSI addon
eksctl create addon \
  --name aws-ebs-csi-driver \
  --cluster knoxchat-cluster \
  --region ap-south-1 \
  --force
Step 8: Update PV/PVC for EBS
You need to replace 
mongo-pv.yml
 with EBS StorageClass. Create new file:

bash
cat > k8s/mongo-storageclass.yml << 'EOF'
apiVersion: storage.k8s.io/v1
kind: StorageClass
metadata:
  name: ebs-sc
provisioner: ebs.csi.aws.com
volumeBindingMode: WaitForFirstConsumer
parameters:
  type: gp3
EOF
Update 
mongo-pvc.yml
:

bash
cat > k8s/mongo-pvc.yml << 'EOF'
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: mongodb-pvc
  namespace: knoxchat
spec:
  accessModes:
    - ReadWriteOnce
  storageClassName: ebs-sc
  resources:
    requests:
      storage: 5Gi
EOF
Step 9: Apply All Manifests
bash
# Namespace first
kubectl apply -f k8s/namespace.yml
# Storage
kubectl apply -f k8s/mongo-storageclass.yml
kubectl apply -f k8s/mongo-pvc.yml
# Secrets & Config
kubectl apply -f k8s/configmap.yml
kubectl apply -f k8s/secrets.yml
# MongoDB
kubectl apply -f k8s/mongo-deployment.yml
kubectl apply -f k8s/mongo-service.yml
# Wait for MongoDB to be ready
kubectl get pods -n knoxchat --watch
# Ctrl+C when mongo shows Running
# App
kubectl apply -f k8s/knoxchat-deployment.yml
kubectl apply -f k8s/knoxchat-service.yml
# Verify all pods
kubectl get pods -n knoxchat
kubectl get svc -n knoxchat
Step 10: Install Nginx Ingress Controller
bash
helm repo add ingress-nginx https://kubernetes.github.io/ingress-nginx
helm repo update
helm install ingress-nginx ingress-nginx/ingress-nginx \
  --namespace ingress-nginx \
  --create-namespace
# Wait for Load Balancer
kubectl get svc -n ingress-nginx --watch
# Wait until EXTERNAL-IP shows an AWS URL (not <pending>)
Step 11: Apply Ingress
bash
kubectl apply -f k8s/ingress.yml
kubectl get ingress -n knoxchat
Step 12: Get the Load Balancer URL
bash
kubectl get svc -n ingress-nginx
# Copy the EXTERNAL-IP like: a1b2c3d4-xxxxx.ap-south-1.elb.amazonaws.com
Test directly:

bash
curl -H "Host: knoxchat.com" http://<LOAD-BALANCER-URL>
Step 13: Point Domain (Optional)
In your DNS provider, add CNAME record:

knoxchat.com â†’ <load-balancer-url>.elb.amazonaws.com
Step 14: Verify Everything
bash
# All pods
kubectl get pods -n knoxchat
# All services
kubectl get svc -n knoxchat
# Ingress
kubectl get ingress -n knoxchat
# Logs
kubectl logs -l app=knoxchat -n knoxchat --tail=20
# Check MongoDB
kubectl exec -it $(kubectl get pod -n knoxchat -l app=mongo -o name) -n knoxchat -- mongosh
Step 15: Test Self-Healing & Scaling
bash
# Scale up
kubectl scale deployment knoxchat-deployment --replicas=3 -n knoxchat
# Delete a pod
kubectl delete pod <pod-name> -n knoxchat
# Watch recovery
kubectl get pods -n knoxchat --watch
ðŸ§¹ CLEANUP (Important â€” Stop Charges!)
bash
eksctl delete cluster --name knoxchat-cluster --region ap-south-1